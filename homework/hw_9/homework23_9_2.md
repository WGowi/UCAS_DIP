小波包是一种可以根据需要对信号进行更多控制的时间/空间-频率分解的工具。它的一种应用是对图像信息的压缩。课本中给出了一个针对指纹图像进行压缩的实例，在该实例中一幅指纹图像可以被至多分解成深度为4的小波包分解树。请计算进行至多3级小波包分解共有多少分解方式？请形式化描述一个基于书中能量函数定义的最优小波包分解树的构建算法（给出计算的流程，假设至多分解深度为N）。



1、请计算进行至多3级小波包分解共有多少分解方式？

因为存在$D(P+1)=\left[D(P)\right]^{4}+1$

可得
$$
D(1)=1\\
D(2)=2\\
D(3)=17\\
D(4)=83522
$$
2、请形式化描述一个基于书中能量函数定义的最优小波包分解树的构建算法（给出计算的流程，假设至多分解深度为N）

输入： 图像f，N

输出：分解树的输出



1.  初始化队列，将节点放入队列
2.  取出队头元素A
3.  若$\frac{\text{width(A)}}{2}<\frac{\text{width(f)}}{2^N}$，则计算相应的小波分解：$A_A,A_H,A_V,A_D$
4.  计算相应的小波分解的能量： $E_A,E_H,E_V,E_D$
5.  若 $E_A+E_H+E_V+E_D<E$，则将$A_A,A_H,A_V,A_D$放入队列，否则将$A$输出为叶子结点
6.  循环上述2-4步，直至队列为空